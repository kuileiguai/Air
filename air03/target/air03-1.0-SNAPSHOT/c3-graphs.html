<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Arise Admin Panel" />
		<meta name="keywords" content="Admin, Dashboard, Bootstrap3, Sass, transform, CSS3, HTML5, Web design, UI Design, Responsive Dashboard, Responsive Admin, Admin Theme, Best Admin UI, Bootstrap Theme, Themeforest, Bootstrap, C3 Graphs, D3 Graphs, NVD3 Graphs, Admin Skin, Black Admin Dashboard, Grey Admin Dashboard, Dark Admin Dashboard, Simple Admin Dashboard, Simple Admin Theme, Simple Bootstrap Dashboard " />
		<meta name="author" content="Ramji" />
		<link rel="shortcut icon" href="img/fav.png">
		<title>C3 Graphs - Arise Admin Panel - shared on themelock.com</title>
		
		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet" media="screen" />

		<!-- Main CSS -->
		<link href="css/main.css" rel="stylesheet" media="screen" />

		<!-- Ion Icons -->
		<link href="fonts/icomoon/icomoon.css" rel="stylesheet" />

		<!-- C3 CSS -->
		<link href="css/c3/c3.css" rel="stylesheet" />

		<!-- HTML5 shiv and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			<script src="js/html5shiv.js"></script>
			<script src="js/respond.min.js"></script>
		<![endif]-->

	</head>

	<body>

		<!-- Header starts -->
		<header>
			<!-- Logo starts -->
			<!-- <a href="index.html" class="logo">
				<img src="img/logo.png" alt="Arise Admin Dashboard Logo" />
			</a> -->
			<!-- Logo ends -->

			<div class="custom-search hidden-sm hidden-xs">
				<input type="text" class="search-query" placeholder="Search here ...">
				<i class="icon-search3"></i>
			</div>
		</header>
		<!-- Header ends -->

		<!-- Left sidebar start -->
		<div class="vertical-nav vertical-nav-sm">

			<!-- Collapse menu starts -->
			<button class="collapse-menu">
				<i class="icon-menu2"></i>
			</button>
			<!-- Collapse menu ends -->

			<!-- Current user starts -->
			<div class="user-details clearfix">
				<a href="javascript:void(0)" class="user-img">
					<img src="img/logo.png" alt="logo Info">
					<span class="likes-info">氣</span>
				</a>
				<h5 class="user-name">大气环境监测系统</h5>
			</div>
			<!-- Current user ends -->

			<!-- Sidebar menu starts -->
			<ul class="menu clearfix">
				<li>
					<a href="index.html">
						<i class="icon-air-play"></i>
						<span class="menu-item">首页</span>
					</a>
				</li>
				<li>
					<a href="javascript:void(0)">
						<i class="icon-calendar-alt-stroke"></i>
						<span class="menu-item">历史记录</span>
						<span class="down-arrow"></span>
					</a>
				</li>
				<li>
					<a href="./c3-map.html">
						<i class="icon-map4"></i>
						<span class="menu-item">实时定位</span>
						<span class="down-arrow"></span>
					</a>
				</li>
				<li>
					<a href="./c3-realtime_data.html">
						<i class="icon-cloud-sun"></i>
						<span class="menu-item">实时监测</span>
						<span class="down-arrow"></span>
					</a>
				</li>
			</ul>
			<!-- Sidebar menu ends -->
		</div>
		<!-- Left sidebar end -->

		<!-- Dashboard Wrapper Start -->
		<div class="dashboard-wrapper">

			<!-- Container fluid Starts -->
			<div class="container-fluid">

				<!-- Top Bar Starts -->
				<div class="top-bar clearfix">
					<div class="row gutter">
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<div class="page-title">
								<h3>24小时监测一览</h3>
								<p> <!-- <a href="index.html">Home</a> --></p>
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<ul class="right-stats" id="mini-nav-right">
								<li>
									<a href="javascript:void(0)" class="btn btn-danger"><i class="icon-hour-glass"></i>for a day</a>
								</li>
								<li>
									<a href="./c3-realtime_data.html" class="btn btn-success">
										<i class="icon-time-slot"></i>for realtime</a>
								</li>
								<li>
									<a href="./c3-map.html" class="btn btn-info"><i class="icon-map3"></i> Map</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<!-- Top Bar Ends -->
<!-- --------------------------------------------------------------------------------------------------------- -->






				<!-- Row starts -->
				<div class="row gutter">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="panel height2" >
							<div class="panel-heading">
								<h4 class="panel-title">AQI 指数</h4>
							</div>
							<div class="panel-body">
								<div id="echart7" class="chart-height1" ></div>
							</div>
						</div>
					</div>
				</div>
				<!-- Row ends -->











				<!-- 把id去掉改成自己的 -->

				<!-- Row starts -->
				<div class="row gutter">
					<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
						<div class="panel height2">
							<div class="panel-heading">
								<h4 class="panel-title">PM2.5 可吸入微粒物</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="lineGraph" class="chart-height1" style="max-height: 225px; position: relative;"></div> -->
								<div id="echart1" class="chart-height1" style="max-height: 325px; position: relative;"></div>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
						<div class="panel height2">
							<div class="panel-heading">
								<h4 class="panel-title">PM10 可吸入微粒物</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="stackedBarGraph" class="chart-height1"></div> -->
								<div id="echart2" class="chart-height1"></div>
							</div>
						</div>
					</div>
				</div>
				<!-- Row ends -->


<script type="text/javascript" src="lib/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="lib/echarts.min.js"></script>
<script type="text/javascript" src="lib/dark.js"></script>

		<script type="text/javascript">
			$(function(){
				// 初始化数据，方便打开的时候先快速展示
				var dom1 = document.getElementById("echart1");
				var dom2 = document.getElementById("echart2");
				var dom3 = document.getElementById("echart3");
				var dom4 = document.getElementById("echart4");
				var dom5 = document.getElementById("echart5");
				var dom6 = document.getElementById("echart6");
				var dom7 = document.getElementById("echart7");

				var myChart1= echarts.init(dom1,'dark');
				var myChart2= echarts.init(dom2,'dark');
				var myChart3= echarts.init(dom3,'dark');
				var myChart4= echarts.init(dom4,'dark');
				var myChart5= echarts.init(dom5,'dark');
				var myChart6= echarts.init(dom6,'dark');
				var myChart7= echarts.init(dom7,'dark');
				//
				xData=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]
				var date=new Date();
				//初始化完以后调用ajax获取数据
				$.ajax({
					url:"base/getListByDate.do",
					// url:"getO3.do",
					data:{
						// 参数是时间
						"now":date.getTime()+""
					},
					type:"get",
					dataType:"json",
					success:function(data){
						//某个时间段落的数据
						// 考虑如果不满足一天怎么办，没事就刚好到那个时刻
						// 期待拿到的数据：ydate，length长度，显示的时间段，布尔值
						if(data.success){
							InitEchart(myChart1,xData,data.pm2_5List,"PM2_5")
							InitEchart(myChart2,xData,data.pm10List,"PM10")
							InitEchart(myChart3,xData,data.coList,"CO")
							InitEchart(myChart4,xData,data.no2List,"NO2")
							InitEchart(myChart5,xData,data.o3List,"O3")
							InitEchart(myChart6,xData,data.so2List,"SO2")
						}else{
							console.log("未知原因获取无法获取数据")
							yData=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
							InitEchart(myChart1,xData,yData,"O3")
							InitEchart(myChart2,xData,yData,"NO2")
							InitEchart(myChart3,xData,yData,"PM2_5")
							InitEchart(myChart4,xData,yData,"PM10")
							InitEchart(myChart5,xData,yData,"CO")
							InitEchart(myChart6,xData,yData,"SO2")
							InitEchartAqi(myChart7,xData,yData,"SO2")
						}
					},
					error:function(e){
						console.log("网络连接失败")
						console.log("未知原因获取无法获取数据")
						yData=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
						InitEchart(myChart1,xData,yData,"O3")
						InitEchart(myChart2,xData,yData,"NO2")
						InitEchart(myChart3,xData,yData,"PM2_5")
						InitEchart(myChart4,xData,yData,"PM10")
						InitEchart(myChart5,xData,yData,"CO")
						InitEchart(myChart6,xData,yData,"SO2")
						InitEchartAqi(myChart7,xData,yData,"SO2")
					}
				})
				//aqi 获取

				$.ajax({
					url:"base/getAqiByDate.do",
					// url:"getO3.do",
					data:{
						// 参数是时间
						"now":date.getTime()+""
					},
					type:"get",
					dataType:"json",
					success:function(data){
						//某个时间段落的数据
						// 考虑如果不满足一天怎么办，没事就刚好到那个时刻
						// 期待拿到的数据：ydate，length长度，显示的时间段，布尔值

						//遍历aqiList  name 和aqi属性变成数组
						
						if(data.success){
							var aqiArray=[]
							var first_pollutionArray=[]
							for(var i=0;i<data.aqiList.length;i++){
								aqiArray[i]=data.aqiList[i].aqi
								// first_pollution_startDate_Array[i]=data.startDateList[i]+"首要污染物: "+data.aqiList[i].name
								first_pollutionArray[i]=data.aqiList[i].name
							}
							InitEchartAqi(myChart7,data.startDateList,aqiArray,first_pollutionArray)
						}else{
							console.log("未知原因获取无法获取数据")
						}
					}
				})

			})
			
			// 传入echart对象和对应的坐标轴数据，x坐标轴可以定义一个常量，毕竟单位不一样
			function InitEchart(myChart,xData,yData,mode){
		 /* 
		 *	GradeA表示浓度限值是一级
		 *	GradeB表示浓度限值是二级
		 *	so2 no2 o3 pm2.5 pm10 nox的单位是ug/m^3 
		 *	co 单位是mg/m^3
		 */
			/* 每条标准对应不同的线 */
			// 单日每小时平均
			var gradeA=0
			var gradeB=0
			var SO2_GradeA=150;
			var SO2_GradeB=500;
			var NO2_GradeA=200;
			var NO2_GradeB=200;//氮氧化物的两个值都是相同的
			var CO_GradeA=10;
			var CO_GradeB=10;
			var O3_GradeA=160;//O3每日8小时平均最大不超过100
			var O3_GradeB=200;
			
			// var NOX_GradeA=250;
			// var NOX_GradeB=250;
			
			// 24小时平均
			var PM2_5GradeA=35;
			var PM2_5GradeB=75;
			var PM10GradeA=50;
			var PM10GradeB=150;
			
			if(mode=="SO2"){
				gradeA=SO2_GradeA
				gradeB=SO2_GradeB
			}else if(mode=="NO2"){
				gradeA=NO2_GradeA
				gradeB=NO2_GradeB
			}else if(mode=="O3"){
				gradeA=O3_GradeA
				gradeB=O3_GradeB
			}else if(mode=="PM2_5"){
				gradeA=PM2_5GradeA
				gradeB=PM2_5GradeB
			}else if(mode=="PM10"){
				gradeA=PM10GradeA
				gradeB=PM10GradeB
			}else if(mode=="CO"){
				gradeA=CO_GradeA
				gradeB=CO_GradeB
			}else{
				console.log("参数输入有误")
			}
		//	判断是否超标
				var app = {};
				var option;
				    myChart.setOption(option = {
				        tooltip: {//控制提示框
				            trigger: 'axis',
							show: true, // 必须引入 tooltip 组件
							axisPointer: {
								type: 'cross',
								/*  {number} 表示坐标轴的下标
								* 	{value} 表示坐标轴的值
								*  */
								// label:{formatter:'some text {value} some text'}
							},
				        },
				        grid: {
				             top:'5%',
				             left: '5%',
				             right: '20%',
				             bottom: '13%'
				        },
				        xAxis: {
							/* 这里是横坐标 */
				            data:xData,
							splitLine: {show: false}  //去除网格线
							// splitArea: {show: false} //去除网格区域
						},
				        yAxis: {
							splitLine: {show: false} //去除网格线
						},
				        toolbox: {
				            right: 10,
				            feature: {
				                dataZoom: {
				                    yAxisIndex: 'none'
				                },
				                restore: {},
				                saveAsImage: {}
				            }
				        },
				        visualMap: {
				            top: 50,
				            right: 10,
				            pieces: [{
				                gt: 0,
				                lte: gradeA,
				                color: '#93CE07'
				            }, {
				                gt: gradeA,
				                lte: gradeB,
				                color: '#FBDB0F'
				            }, {
				                gt: gradeB,
				                lte: 1000,
				                color: '#FD0100'
				            }],
				            outOfRange: {
				                color: '#FD0100'
				            }
				        },
				        series: {
				            name: mode+'(绿色:优 黄色:污染一级 红色:污染二级)',
				            type: 'line',
							/* 这里是纵坐标 */
				            data: yData,
				            markLine: {
				                silent: true,
				                lineStyle: {
				                    color: '#fbdb0f'
				                },
				                data: [{
				                    yAxis: gradeA
				                }, {
				                    yAxis: gradeA
				                }]
				            }
				        }
				    });
				if (option && typeof option === 'object') {
				    myChart.setOption(option);
				}
			}

			function InitEchartAqi(myChart,xData,yData,first_pollutionArray){
				//	判断是否超标
				var app = {};
				var option;
				myChart.setOption(option = {
					title: {
						text: 'AQI指数分布',
						right: '5%',
						top:'15%'
					},
					tooltip: {
						trigger: 'axis',
						show: true, // 必须引入
						axisPointer: {
							type: 'line',
							label:{formatter: function (params) {  //实时显示首要污染物算法
									return first_pollutionArray[parseInt(((params.value)+"").substring(1,3))]
								}}
						},
					},
					grid: {
						top:'5%',
						left: '5%',
						right: '20%',
						bottom: '13%'
					},
					xAxis: {
						data: xData,
						splitLine: {show: false}
					},
					yAxis: {splitLine: {show: false}},
					toolbox: {
						right: 10,
						feature: {
							dataZoom: {
								yAxisIndex: 'none'
							},
							restore: {},
							saveAsImage: {}
						}

					},
					visualMap: {
						top: 50,
						right: 10,
						pieces: [{
							gt: 0,
							lte: 50,
							color: '#93CE07'
						}, {
							gt: 50,
							lte: 100,
							color: '#FBDB0F'
						}, {
							gt: 100,
							lte: 150,
							color: '#FC7D02'
						}, {
							gt: 150,
							lte: 200,
							color: '#FD0100'
						}, {
							gt: 200,
							lte: 300,
							color: '#AA069F'
						}, {
							gt: 300,
							color: '#AC3B2A'
						}],
						outOfRange: {
							color: '#999'
						}
					},
					series: {
						name: 'AQI ',
						type: 'line',
						data: yData,
						markLine: {
							silent: true,
							lineStyle: {
								color: '#95a0b1'
							},
							data: [{
								yAxis: 50
							}, {
								yAxis: 100
							}, {
								yAxis: 150
							}, {
								yAxis: 200
							}, {
								yAxis: 300
							}]
						}
					}
				});
				if (option && typeof option === 'object') {
					myChart.setOption(option);
				}
			}

		</script>







				<!-- Row starts -->
				<div class="row gutter">
					<div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
						<div class="panel height2">
							<div class="panel-heading">
								<h4 class="panel-title">CO 一氧化碳</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="scatterPlot" class="chart-height1"></div> -->
								<div id="echart3" class="chart-height1"></div>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
						<div class="panel height2">
							<div class="panel-heading">
								<h4 class="panel-title">NO2 氮氧化物</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="stepGraph" class="chart-height1"></div> -->
								<div id="echart4" class="chart-height1"></div>
							</div>
						</div>
					</div>
				</div>
				<!-- Row ends -->

				<!-- Row starts -->
				<div class="row gutter">
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="panel height2">
							<div class="panel-heading">
								<h4 class="panel-title">O3</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="splineGraph" class="chart-height1"></div> -->
								<div id="echart5" class="chart-height1"></div>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="panel height2">
							<div class="panel-heading">
								<h4 class="panel-title">SO2 二氧化硫</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="barAreaGraph" class="chart-height1"></div> -->
								<div id="echart6" class="chart-height1"></div>
							</div>
						</div>
					</div>
				</div>
				<!-- Row ends -->



			</div>
			<!-- Container fluid ends -->
			
		</div>
		<!-- Dashboard Wrapper End -->

		<!-- Footer Start -->
		<footer>
			@ 基于NB-IOT <a href="http://www.bootstrapmb.com/">的</a> 网格化大气 <span>监测系统</span>
		</footer>
		<!-- Footer end -->

		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="js/jquery.js"></script>

		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="js/bootstrap.min.js"></script>
		
		<!-- jquery ScrollUp JS -->
		<script src="js/scrollup/jquery.scrollUp.js"></script>

		<!-- D3 JS -->
		<script src="js/d3/d3.v3.min.js"></script>

		<!-- C3 Graphs -->
		<script src="js/c3/c3.min.js"></script>
		<script src="js/c3/c3.custom.js"></script>

		<!-- Custom JS -->
		<script src="js/custom.js"></script>
	</body>
</html>