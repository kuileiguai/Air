<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Arise Admin Panel" />
		<meta name="keywords" content="Admin, Dashboard, Bootstrap3, Sass, transform, CSS3, HTML5, Web design, UI Design, Responsive Dashboard, Responsive Admin, Admin Theme, Best Admin UI, Bootstrap Theme, Themeforest, Bootstrap, C3 Graphs, D3 Graphs, NVD3 Graphs, Admin Skin, Black Admin Dashboard, Grey Admin Dashboard, Dark Admin Dashboard, Simple Admin Dashboard, Simple Admin Theme, Simple Bootstrap Dashboard, Flot Graphs, Custom Flot Graphs " />
		<meta name="author" content="Ramji" />
		<link rel="shortcut icon" href="img/fav.png">
		<title>Flot Graphs - Arise Admin Panel - shared on themelock.com</title>
		
		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet" media="screen" />

		<!-- Main CSS -->
		<link href="css/main.css" rel="stylesheet" media="screen" />

		<!-- Ion Icons -->
		<link href="fonts/icomoon/icomoon.css" rel="stylesheet" />

		<!-- HTML5 shiv and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			<script src="js/html5shiv.js"></script>
			<script src="js/respond.min.js"></script>
		<![endif]-->

	</head>

	<body>

		<!-- Header starts -->
		<header>

			<!-- Logo starts -->
			<!-- <a href="index.html" class="logo">
				<img src="img/logo.png" alt="Arise Admin Dashboard Logo" />
			</a> -->
			<!-- Logo ends -->

			<div class="custom-search hidden-sm hidden-xs">
				<input type="text" class="search-query" placeholder="Search here ...">
				<i class="icon-search3"></i>
			</div>
		</header>
		<!-- Header ends -->

		<!-- Left sidebar start -->
		<div class="vertical-nav vertical-nav-sm">

			<!-- Collapse menu starts -->
			<button class="collapse-menu">
				<i class="icon-menu2"></i>
			</button>
			<!-- Collapse menu ends -->
			
			<!-- Current user starts -->
			<div class="user-details clearfix">
				<a href="javascript:void(0)" class="user-img">
					<img src="img/logo.png" alt="logo Info">
					<span class="likes-info">氣</span>
				</a>
				<h5 class="user-name">大气环境监测系统</h5>
			</div>
			<!-- Current user ends -->

			<!-- Sidebar menu starts -->
			<ul class="menu clearfix">
				<li>
					<a href="index.html">
						<i class="icon-air-play"></i>
						<span class="menu-item">首页</span>
					</a>
				</li>
				<li>
					<a href="./c3-graphs.html">
						<i class="icon-calendar-alt-stroke"></i>
						<span class="menu-item">历史记录</span>
						<span class="down-arrow"></span>
					</a>
				</li>
				<li>
					<a href="javascript:void(0)">
						<i class="icon-map4"></i>
						<span class="menu-item">实时定位</span>
						<span class="down-arrow"></span>
					</a>
				</li>
				<li>
					<a href="./c3-realtime_data.html">
						<i class="icon-cloud-sun"></i>
						<span class="menu-item">实时监测</span>
						<span class="down-arrow"></span>
					</a>
				</li>
			</ul>
			<!-- Sidebar menu ends -->
		</div>
		<!-- Left sidebar end -->

		<!-- Dashboard Wrapper Start -->
		<div class="dashboard-wrapper">

			<!-- Container fluid Starts -->
			<div class="container-fluid">
				
				
				
				<!-- Top Bar Starts -->
				<div class="top-bar clearfix">
					<div class="row gutter">
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<div class="page-title">
								<h3>地图定位</h3>
								<p> <!-- <a href="index.html">Home</a> --></p>
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<ul class="right-stats" id="mini-nav-right">
								<li>
									<a href="./c3-graphs.html" class="btn btn-danger"><i class="icon-hour-glass"></i>for a day</a>
								</li>
								<li>
									<a href="./c3-realtime_data.html" class="btn btn-success">
										<i class="icon-time-slot"></i>for realtime</a>
								</li>
								<li>
									<a href="javascript:void(0)" class="btn btn-info"><i class="icon-map3"></i> Map</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<!-- Top Bar Ends -->
				
				
				
				
				<div class="row gutter">
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="panel height2" style="height: 600px;">
							<div class="panel-heading">
								<h4 class="panel-title">基于GPS的定位系统</h4>
							</div>
							<div class="panel-body">
								<!-- <div id="splineGraph" class="chart-height1"></div> -->
								<div id="a_map" class="chart-height1" style="height: 500px;"></div>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<div class="height2"  style="overflow: hidden">
<!--							<div class="panel-heading">-->
<!--								<h4 class="panel-title"></h4>-->
<!--							</div>-->
							<div class="panel-body">
								<!-- <div id="barAreaGraph" class="chart-height1"></div> -->
								<div id="echart6" class="chart-height1" style="width: 100%;height: 400px;"></div>
							</div>
						</div>
						<div class="panel panel-blue">
							<div class="panel-body">
								<div class="table-responsive">
									<table id="basicExample" class="table table-striped table-condensed table-bordered no-margin">
<!--										<thead>-->
<!--										-->
<!--										</thead>-->
										<!-- <tfoot>
										  <tr>
												<th>Name</th>
												<th>Position</th>
												<th>Office</th>
												<th>Age</th>
												<th>Start date</th>
												<th>Salary</th>
										  </tr> -->
<!--										</tfoot>-->
										<tbody id="tbody_show_data">
										<tr>
											<th width="50">名称</th>
											<th width="60">O3</th>
											<th width="60">PM2.5</th>
											<th width="60">PM10</th>
											<th width="60">CO</th>
											<th width="60">NO2</th>
											<th width="60">SO2</th>
										</tr>
										<tr>
										<th width="50">数值</th>
										<th width="50"></th>
										<th width="50"></th>
										<th width="50"></th>
										<th width="50"></th>
										<th width="50"></th>
										<th width="50"></th>
										</tr>
										<tr>
										<th width="50">名称</th>
										<th width="80">时间</th>
										<th width="80">经度</th>
										<th width="80">纬度</th>
										<th width="80">AQI</th>
										</tr>
										<tr>
										<th width="50">数值</th>
										<th width="80"></th>
										<th width="80"></th>
										<th width="80"></th>
										<th width="80"></th>
										</tr>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>





				<!--		<script src="js/jquery-3.5.1.min.js"></script>-->
				<script src="lib/echarts.min.js"></script>
				
				<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
				<script src="lib/jquery-3.5.1.min.js"></script>
				
				
				
				
				<script src="file/echarts.min.js"></script>
				<script src="https://api.map.baidu.com/api?v=2.0&ak=3VVO4E7XHGFYhhyHjU07Mr6kkqIi0f8P"></script>
				<script src="file/bmap.min.js"></script>

				<!-- Custom JS -->
<!--				<script src="js/custom.js"></script>-->
				<script src="lib/dark.js"></script>
				
				<script type="text/javascript">
					getRealtimeMapData()

					function init_tbody_show_data(show_data,aqi,first_pollution){
						//console.log(show_data.pm2_5);
						var html=""
						html+='<tr>\n' +
								'<th width="50">名称</th>\n' +
								'<th width="60">O3</th>\n' +
								'<th width="60">PM2.5</th>\n' +
								'<th width="60">PM10</th>\n' +
								'<th width="60">CO</th>\n' +
								'<th width="60">NO2</th>\n' +
								'<th width="60">SO2</th>\n' +
								'</tr>\n' +
								'<tr>\n' +
								'<th width="50">数值</th>\n' +
								'<th width="50">'+show_data.o3+'</th>\n' +
								'<th width="50">'+show_data.pm2_5+'</th>\n' +
								'<th width="50">'+show_data.pm10+'</th>\n' +
								'<th width="50">'+show_data.co+'</th>\n' +
								'<th width="50">'+show_data.no2+'</th>\n' +
								'<th width="50">'+show_data.so2+'</th>\n' +
								'</tr>'+
								'<tr>\n' +
								'<th width="50">名称</th>' +
								'<th width="80">时间</th>' +
								'<th width="80">经度</th>' +
								'<th width="80">纬度</th>' +
								'<th width="80">AQI</th>' +
								'<th width="80">首要污染物</th>' +
								'</tr>' +
								'<tr>' +
								'<th width="50">数值</th>' +
								'<th width="80">'+show_data.startDate+'</th>' +
								'<th width="80">'+show_data.longitude+'</th>' +
								'<th width="80">'+show_data.atitude+'</th>' +
								'<th width="80">'+aqi+'</th>' +
								'<th width="80">'+first_pollution+'</th>' +
								'</tr>'
						$("#tbody_show_data").html(html)
					}

					function initChart6(aqi){
						var dom = document.getElementById("echart6");
						var myChart = echarts.init(dom);
						var app = {};
						var option;
						
						option = {
							grid: {
							         bottom: 5
							},
							series: [{
								type: 'gauge',
								startAngle: 180,
								endAngle: 0,
								min: 0,
								max: 1,
								splitNumber: 8,
								axisLine: {
									lineStyle: {
										width: 6,
										color: [
											[0.2, '#93ce07'],
											[0.4, '#fbdb0f'],
											[0.6,'#aa069f'],
											[0.8, '#fc7d02'],
											[1, '#e41a17']
										]
									}
								},
								axisTick: {
									length: 12,
									lineStyle: {
										color: 'auto',
										width: 2
									}
								},
								splitLine: {
									length: 20,
									lineStyle: {
										color: 'auto',
										width: 5
									}
								},
								axisLabel: {
									color: '#bfbfbf',
									fontSize: 20,
									distance: 20,
									formatter: function (value) {
										if (value === 1) {
											return '重度污染';
										}
										else if (value === 0.750) {
											return '中度污染';
										}
										else if (value === 0.500) {
											return '轻度污染';
										}
										else if (value === 0.250) {
											return '良';
										}else if (value === 0){
											return '优';
										}
									}
								},
								title: {
									offsetCenter: [0, '-20%'],
									fontSize: 30
								},
								detail: {
									fontSize: 50,
									offsetCenter: [0, '25%'],
									valueAnimation: true,
									formatter: function (value) {
										return Math.round(value*300) ;
									},
									color: 'auto'
								},
								data: [{
									value: aqi/300.0,
									name: 'AQI'
								}]
							}]
						};

						if (option && typeof option === 'object') {
							myChart.setOption(option);
						}
					}

					function initMap(geoCoordMap,res) {

					    // 基于准备好的dom，初始化echarts实例
					    var myChart = echarts.init(document.getElementById('a_map'));
						console.log(geoCoordMap,res)
					    option = {
					        title: {
					            text: '全国主要城市空气质量 - 百度地图',
					            subtext: 'data from PM25.in',
					            left: 'center'
					        },
					        tooltip: {
					            trigger: 'item'
					        },
					        bmap: {
					            center: geoCoordMap,
					            zoom: 9,
					            roam: true,
								mapStyle: {
									styleJson: [
										{
											"featureType": "water",
											"elementType": "all",
											"stylers": {
												"color": "#044161"
											}
										},
										{
											"featureType": "land",
											"elementType": "all",
											"stylers": {
												"color": "#004981"
											}
										},
										{
											"featureType": "boundary",
											"elementType": "geometry",
											"stylers": {
												"color": "#064f85"
											}
										},
										{
											"featureType": "railway",
											"elementType": "all",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "highway",
											"elementType": "geometry",
											"stylers": {
												"color": "#004981"
											}
										},
										{
											"featureType": "highway",
											"elementType": "geometry.fill",
											"stylers": {
												"color": "#005b96",
												"lightness": 1
											}
										},
										{
											"featureType": "highway",
											"elementType": "labels",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "arterial",
											"elementType": "geometry",
											"stylers": {
												"color": "#004981"
											}
										},
										{
											"featureType": "arterial",
											"elementType": "geometry.fill",
											"stylers": {
												"color": "#00508b"
											}
										},
										{
											"featureType": "poi",
											"elementType": "all",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "green",
											"elementType": "all",
											"stylers": {
												"color": "#056197",
												"visibility": "off"
											}
										},
										{
											"featureType": "subway",
											"elementType": "all",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "manmade",
											"elementType": "all",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "local",
											"elementType": "all",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "arterial",
											"elementType": "labels",
											"stylers": {
												"visibility": "off"
											}
										},
										{
											"featureType": "boundary",
											"elementType": "geometry.fill",
											"stylers": {
												"color": "#029fd4"
											}
										},
										{
											"featureType": "building",
											"elementType": "all",
											"stylers": {
												"color": "#1a5787"
											}
										},
										{
											"featureType": "label",
											"elementType": "all",
											"stylers": {
												"visibility": "off"
											}
										}
									]
								}
					        },
					        series: [{
					            name: '位置 / AQI',
					            type: 'effectScatter',
					            coordinateSystem: 'bmap',
					            data: res,
					            symbolSize: 15,
					            label: {
					                normal: {
					                    formatter: '{b}',
					                    position: 'right',
					                    show: true
					                },
									color: '#ffffff',
					                emphasis: {
					                    show: true
					                }
					            },
								itemStyle: {
									normal: {
										color: {
											type: 'radial',
											x: 0.5,
											y: 0.5,
											r: 0.5,
											colorStops: [{
												offset: 0, color: 'red' // 0% 处的颜色
											}, {
												offset: 1, color: '#9a6255' // 100% 处的颜色
											}],
											global: false // 缺省为 false
										}
									}
								},
								encode: {
									value: 2
								},
								showEffectOn: 'render',
								rippleEffect: {
									brushType: 'stroke'
								},
								hoverAnimation: true,
					        },
					           /* {
					                name: 'AQI',
					                type: 'effectScatter',
					                coordinateSystem: 'bmap',
					                data: diu,
					                symbolSize: function(val) {
					                    return val[2] / 10;
					                },
					                showEffectOn: 'render',
					                rippleEffect: {
					                    brushType: 'stroke'
					                },
					                hoverAnimation: true,
					                label: {
					                    normal: {
					                        formatter: '{b}',
					                        position: 'right',
					                        show: true
					                    }
					                },
					                itemStyle: {
					                    normal: {
					                        color: 'rgba(78,45,56)',
					                        shadowBlur: 10,
					                        shadowColor: '#333'
					                    }
					                },
					                zlevel: 2
					            }*/
					        ]
					    }
					
					    // 使用刚指定的配置项和数据显示图表。
					    myChart.setOption(option);
					}
					
					function getRealtimeMapData() {
						var date=new Date();
						$.ajax({
							// url:"base/getRealtimeMapData.do",
							url:"base/getAverageHoursData.do",
							type:"get",
							data:{
								// 参数是时间
								"now":date.getTime()+""
							},
							dataType:"json",
							success:function(data){
								if(data.success){
									// 基于准备好的dom，初始化echarts实例
									//var myChart = echarts.init(document.getElementById('a_map'));
									console.log(data.realtimeMapData.mapname)
									var mapname=[]
									mapname.push({
										name: data.realtimeMapData.mapname,
										value: [113.377, 23.137,112]
									});
									initMap(data.geoCoordMap,mapname);
									initChart6(data.res[0].value[2])
									//首要污染物
									var first_pollution = data.res[0].name;
									init_tbody_show_data(data.realtimeMapData,data.res[0].value[2],first_pollution)
								}else{
									console.log("获取地图数据失败 getMapData");
									var initData=[]
									initData.push({
										name: "获取数据失败",
										value: [113.377, 23.137,112]
									});
									initMap([113.377, 23.137,112],initData);
									initChart6(0)
									// init_tbody_show_data("")
								}
							},
							error:function (e) {
								console.log(e)
								var initData=[]
								initData.push({
									name: "获取数据失败",
									value: [113.377, 23.137,112]
								});
								initMap([113.377, 23.137,112],initData);
								initChart6(0)
							}
						})
					}
				</script>
				
				
				
				
				
				
				
				
				

<!--				&lt;!&ndash; Row start &ndash;&gt;-->
<!--				<div class="row gutter">-->
<!--					<div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">-->
<!--						<div class="panel">-->
<!--							<div class="panel-heading">-->
<!--								<h4>Line Chart</h4>-->
<!--							</div>-->
<!--							<div class="panel-body">-->
<!--								<div id="line-chart" class="chart-height3"></div>-->
<!--							</div>-->
<!--						</div>-->
<!--					</div>-->
<!--				-->
<!--				</div>-->
<!--				&lt;!&ndash; Row ends &ndash;&gt;-->

<!--				&lt;!&ndash; Row start &ndash;&gt;-->
<!--				<div class="row gutter">-->
<!--					<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">-->
<!--						<div class="panel">-->
<!--							<div class="panel-heading">-->
<!--								<h4>Combine Chart</h4>-->
<!--							</div>-->
<!--							<div class="panel-body">-->
<!--								<div id="combineChart" class="chart-height3"></div>-->
<!--							</div>-->
<!--						</div>-->
<!--					</div>-->
<!--				-->
<!--				</div>-->
<!--				&lt;!&ndash; Row ends &ndash;&gt;-->



<!--				&lt;!&ndash; Row start &ndash;&gt;-->
<!--				<div class="row gutter">-->
<!--					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">-->
<!--						<div class="panel no-margin">-->
<!--							<div class="panel-heading">-->
<!--								<h4>Realtime Chart</h4>-->
<!--							</div>-->
<!--							<div class="panel-body">-->
<!--								<div id="flot-placeholder" class="chart-height3"></div>-->
<!--							</div>-->
<!--						</div>-->
<!--					</div> -->
<!--				</div>-->
<!--				&lt;!&ndash; Row ends &ndash;&gt;-->

			</div>
			<!-- Container fluid ends -->
			
		</div>
		<!-- Dashboard Wrapper End -->

		<!-- Footer Start -->
		<footer>
			@ 基于NB-IOT <a href="http://www.bootstrapmb.com/">的</a> 网格化大气 <span>监测系统</span>
		</footer>
		<!-- Footer end -->

		<!-- jQuery (necessary for Bootstrap's JavaScript plugins)??????????? -->
		<script src="js/jquery.js"></script>

		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="js/bootstrap.min.js"></script>
		
		<!-- jquery ScrollUp JS -->
		<script src="js/scrollup/jquery.scrollUp.js"></script>

		<!-- Flot Charts -->
    <script src="js/flot/jquery.flot.js"></script>
    <script src="js/flot/jquery.flot.orderBar.min.js"></script>
    <script src="js/flot/jquery.flot.pie.min.js"></script>
    <script src="js/flot/jquery.flot.stack.min.js"></script>
    <script src="js/flot/jquery.flot.tooltip.min.js"></script>
    <script src="js/flot/jquery.flot.resize.min.js"></script>

    <!-- Custom JS -->
    <script src="js/flot/custom/line.js"></script>
    <script src="js/flot/custom/area.js"></script>
    <script src="js/flot/custom/combine-chart.js"></script>
    <script src="js/flot/custom/combine-chart-compare.js"></script>
    <script src="js/flot/custom/stacked-area.js"></script>
    <script src="js/flot/custom/vertical.js"></script>
    <script src="js/flot/custom/horizontal.js"></script>
    <script src="js/flot/custom/stacked-vertical.js"></script>
    <script src="js/flot/custom/stacked-horizontal.js"></script>
    <script src="js/flot/custom/rectangular-pie.js"></script>
    <script src="js/flot/custom/realtime.js"></script>
    <script src="js/flot/custom/pie.js"></script>
    <script src="js/flot/custom/donut.js"></script>
    <script src="js/flot/custom/scatter.js"></script>

		<!-- Custom JS -->
		<script src="js/custom.js"></script>
	</body>
</html>